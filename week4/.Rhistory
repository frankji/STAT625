#
# Statistical Clinic, Sept 16, 2016
# Adapted for use in Case Studies, Sept 20, 2016
#
files <- dir("Sept20NH_625", full.names = TRUE)
all <- lapply(files, read.csv, as.is=TRUE)
netids <- gsub(".*625_(.*).csv", "\\1", files)
names(all) <- netids
sapply(all, dim)
allvars <- names(all[[1]])
allvars <- allvars[-grep("pid", allvars)]
length(allvars)
sapply(all, function(a) length(intersect(allvars, names(a))))
names(all[[8]])[40] <- "multibuilding"
names(all[[12]])[19] <- "bathstyle"
checkvar <- function(thisvar) {
sapply(all, function(a) thisvar %in% names(a))
}
for (thisvar in allvars) {
cat(thisvar, sum(checkvar(thisvar)), "\n")
if (sum(checkvar(thisvar)) < 12) print(checkvar(thisvar))
}
multi <- as.data.frame(sapply(all, function(a) a[,"multibuilding"]),
stringsAsFactors=FALSE)
multi <- apply(multi, 1, sum, na.rm=TRUE) == length(all)
#all <- all[-5]       # Oops.
#lapply(all, names)
# thisvar <- "acres" # To check a single variable instead of looping
sink("TuesdayAM.txt")
for (thisvar in allvars) {
cat("***************************************************\n")
cat(">>>>>>>>>>>>>>>>>>>>>>>>", thisvar, "\n")
x <- as.data.frame(sapply(all, function(a) a[,thisvar]),
stringsAsFactors=FALSE)
x[multi,] <- NA # blow away the multibuilding data
table(nums <- apply(x, 1, function(a) length(unique(a))))
for (i in 2:ncol(x)) {
if (any(nums==i)) {
cat("\n\n----------------------", i, "\n")
temp <- x[nums==i,]
cat("# times there were", i, "unique values:",
nrow(temp), "\n")
print(temp[sample(1:nrow(temp), min(10,nrow(temp))),])
}
}
}
sink()
#
# Statistical Clinic, Sept 16, 2016
# Adapted for use in Case Studies, Sept 20, 2016
#
files <- dir("Sept20NH_625", full.names = TRUE)
all <- lapply(files, read.csv, as.is=TRUE)
netids <- gsub(".*625_(.*).csv", "\\1", files)
names(all) <- netids
sapply(all, dim)
allvars <- names(all[[1]])
allvars <- allvars[-grep("pid", allvars)]
length(allvars)
sapply(all, function(a) length(intersect(allvars, names(a))))
names(all[[8]])[40] <- "multibuilding"
names(all[[12]])[19] <- "bathstyle"
checkvar <- function(thisvar) {
sapply(all, function(a) thisvar %in% names(a))
}
for (thisvar in allvars) {
cat(thisvar, sum(checkvar(thisvar)), "\n")
if (sum(checkvar(thisvar)) < 12) print(checkvar(thisvar))
}
multi <- as.data.frame(sapply(all, function(a) a[,"multibuilding"]),
stringsAsFactors=FALSE)
multi <- apply(multi, 1, sum, na.rm=TRUE) == length(all)
#all <- all[-5]       # Oops.
#lapply(all, names)
# thisvar <- "acres" # To check a single variable instead of looping
sink("TuesdayAM.txt")
for (thisvar in allvars) {
cat("***************************************************\n")
cat(">>>>>>>>>>>>>>>>>>>>>>>>", thisvar, "\n")
x <- as.data.frame(sapply(all, function(a) a[,thisvar]),
stringsAsFactors=FALSE)
x[multi,] <- NA # blow away the multibuilding data
table(nums <- apply(x, 1, function(a) length(unique(a))))
for (i in 2:ncol(x)) {
if (any(nums==i)) {
cat("\n\n----------------------", i, "\n")
temp <- x[nums==i,]
cat("# times there were", i, "unique values:",
nrow(temp), "\n")
print(temp[sample(1:nrow(temp), min(10,nrow(temp))),])
}
}
}
sink()
