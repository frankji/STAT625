geo<-read.csv('geocoded_dj333.csv', as.is = TRUE)
geo<-read.csv('geocoded_dj333.csv', as.is = TRUE)
geo<-read.csv('geocoded_dj333.csv', as.is = TRUE)
bu<-read.csv('all_addresses.csv', as.is = TRUE)
View(bu)
bu<-read.csv('address_lat_long.csv', as.is = TRUE)
View(bu)
View(geo)
bu<-bu[, c('pid','lat','lon')]
View(bu)
bu<-bu[, c('pid','latitude','longitude')]
colnames(bu)<-c('pid', 'lat', 'lon')
View(bu)
sapply(1:27303, function(x) all(is.na(geo[x,c('lat', 'lon')],
bu[x, c('lat', 'lon')]))
)
geo <- read.csv('geocoded_dj333.csv', as.is = TRUE)
bu <- bu[, c('pid', 'latitude', 'longitude')]
colnames(bu) <- c('pid', 'lat', 'lon')
sapply(1:27303, function(x) all(is.na(geo[x,c('lat', 'lon')], bu[x, c('lat', 'lon')])))
geo <- read.csv('geocoded_dj333.csv', as.is = TRUE)
bu <- read.csv('address_lat_long.csv', as.is = TRUE)
bu <- bu[, c('pid', 'latitude', 'longitude')]
colnames(bu) <- c('pid', 'lat', 'lon')
sapply(1:27303, function(x) all(is.na(geo[x,c('lat', 'lon')], bu[x, c('lat', 'lon')])))
x=1
colnames(bu) <- c('pid', 'lat', 'lon')
sapply(1:27303, function(x) all(is.na(geo[x,c('lat', 'lon')], bu[x, c('lat', 'lon')])))
sapply(1:27303, function(x) all(is.na(c(geo[x,c('lat', 'lon')], bu[x, c('lat', 'lon')]))))
miss.geo<-sapply(1:27303, function(x) all(is.na(c(geo[x,c('lat', 'lon')]))))
apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
miss.geo<-apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
miss.geo
miss.bu <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
miss.bu
which(geo$pid!=bu$pid)
comp <- cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon)
comp
comp <- cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon)
colnames(comp) <- c('pid', 'lat1', 'lon1', 'lat2', 'lon2')
comp[, 'Missing1'] <- apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp[, 'Missing2'] <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp
comp <- as.data.frame(cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon))
colnames(comp) <- c('pid', 'lat1', 'lon1', 'lat2', 'lon2')
comp[, 'Missing1'] <- apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp[, 'Missing2'] <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp$Missing1
View(comp)
library('geosphere')
apply(comp[!comp[, 'Missing'] & !comp[, 'Missing2'], ], 1, function(x) distm(x, fun = distHaversine))
no.mis <- !comp[, 'Missing1'] & !comp[, 'Missing2']
comp[, 'Dist'] <- NA
comp[nomis, 'Dist']<-apply(comp[no.mis, ], 1, function(x) distm(x, fun = distHaversine))
comp[, 'Dist'] <- NA
comp[nomis, 'Dist']<-apply(comp[no.mis, ], 1, function(x) distm(x[1:2], x[3:4], fun = distHaversine))
range(comp[, 2:5])
range(comp[, 2])
range(comp[, 2], na.rm = TRUE)
range(comp[, 3], na.rm = TRUE)
range(comp[, 4], na.rm = TRUE)
range(comp[, 5], na.rm = TRUE)
comp[nomis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[1:2], x[3:4], fun = distHaversine))
comp[,3]
comp[, 3]
comp[, 3] < -100
comp[comp[, 3] < -100,]
which(comp[, 3] < -100)
comp[comp[, 3] < -100, ]
which(comp[, 3] < -100)
View(comp[which(comp[, 3] < -100), ])
comp[nomis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[1:2], x[3:4], fun = distHaversine))
?distm
comp[, 'Dist'] <- NA
comp[nomis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[2, 1], x[4, 3], fun = distHaversine))
comp[nomis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[c(2, 1)], x[c(4, 3)], fun = distHaversine))
library('geosphere')
geo <- read.csv('geocoded_dj333.csv', as.is = TRUE)
bu <- read.csv('address_lat_long.csv', as.is = TRUE)
bu <- bu[, c('pid', 'latitude', 'longitude')]
colnames(bu) <- c('pid', 'lat', 'lon')
comp <- as.data.frame(cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon))
colnames(comp) <- c('pid', 'lat1', 'lon1', 'lat2', 'lon2')
comp[, 'Missing1'] <- apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp[, 'Missing2'] <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
no.mis <- !comp[, 'Missing1'] & !comp[, 'Missing2']
comp[, 'Dist'] <- NA
comp[nomis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[c(2, 1)], x[c(4, 3)], fun = distHaversine))
library('geosphere')
geo <- read.csv('geocoded_dj333.csv', as.is = TRUE)
bu <- read.csv('address_lat_long.csv', as.is = TRUE)
bu <- bu[, c('pid', 'latitude', 'longitude')]
colnames(bu) <- c('pid', 'lat', 'lon')
comp <- as.data.frame(cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon))
colnames(comp) <- c('pid', 'lat1', 'lon1', 'lat2', 'lon2')
comp[, 'Missing1'] <- apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp[, 'Missing2'] <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
no.mis <- !comp[, 'Missing1'] & !comp[, 'Missing2']
comp[, 'Dist'] <- NA
comp[no.mis, 'Dist']<-apply(comp[no.mis, 2:5], 1, function(x) distm(x[c(2, 1)], x[c(4, 3)], fun = distHaversine))
View(comp)
library('geosphere')
geo <- read.csv('geocoded_dj333.csv', as.is = TRUE)
bu <- read.csv('address_lat_long.csv', as.is = TRUE)
bu <- bu[, c('pid', 'latitude', 'longitude')]
colnames(bu) <- c('pid', 'lat', 'lon')
comp <- as.data.frame(cbind(geo$pid, geo$lat, geo$lon, bu$lat, bu$lon))
colnames(comp) <- c('pid', 'lat1', 'lon1', 'lat2', 'lon2')
comp[, 'Missing1'] <- apply(geo[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
comp[, 'Missing2'] <- apply(bu[, c('lat' ,'lon')], 1, function(x) all(is.na(x)))
no.mis <- !comp[, 'Missing1'] & !comp[, 'Missing2']
comp[, 'Dist'] <- NA
edist<-function(x) distm(x[1:2], x[3:4], fun = distVincentyEllipsoid)
comp[no.mis, 'Dist'] <- apply(comp[no.mis, c(3, 2, 5, 4)], 1, edist)
View(comp)
hist(comp[, 'Dist'])
sum(comp[, "Dist"] > 100, na.rm = TRUE)
sum(comp[, "Dist"] < 100, na.rm = TRUE)
